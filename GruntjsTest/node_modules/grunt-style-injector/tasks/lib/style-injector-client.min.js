!function(){function a(a){var b;return w.cache[a]?w.cache[a].elem:(b=document.getElementById(a),b?(w.cache[a]={},w.cache[a].elem=document.getElementById(a),b):!1)}function b(a){return a.target||a.srcElement}function c(a){a.ghostMode&&o(a.ghostMode),w.id=a.id}function d(){var a=document.getScroll()[1],b=(new Date).getTime();w.lastScroll||(w.scrollTop=a[0],w.lastScroll=(new Date).getTime()),b>w.lastScroll+50&&(w.disabled||(w.lastScroll=b,socket.emit("scroll",{pos:a,ghostId:w.id,url:w.currentUrl}))),w.disabled=!1}function e(a){var c=b(a);socket.emit("input:focus",{id:c.id}),("text"===c.type||"textarea"===c.type)&&c[w.eventListener](w.prefix+"keyup",f,!1)}function f(a){var c=b(a);socket.emit("input:type",{id:c.id,value:c.value})}function g(a){var c=b(a);("text"===c.type||"textarea"===c.type)&&c[w.removeEventListener]("keyup")}function h(a,b,c){for(var d=0,e=a.length;e>d;d+=1)a[d][w.eventListener](w.prefix+b,c,!1)}function i(a){var c=b(a);socket.emit("input:select",{id:c.id,value:c.value})}function j(a){var c=b(a);socket.emit("input:radio",{id:c.id,value:c.value})}function k(a){var c=b(a);socket.emit("input:checkbox",{id:c.id,checked:c.checked})}function l(){this.blur(),this.focus()}function m(a){if(!w.disabled){var c=b(a);socket.emit("form:submit",{id:c.id})}}function n(){for(var a=document.getElementsByTagName("input"),b=[],c=[],d=[],e=0,f=a.length;f>e;e+=1)"text"===a[e].type&&b.push(a[e]),"radio"===a[e].type&&c.push(a[e]),"checkbox"===a[e].type&&d.push(a[e]);return{texts:b,radios:c,checkboxes:d}}function o(a){if(a.scroll&&window[w.eventListener](w.prefix+"scroll",d,!1),a.links){var b=document.getElementsByTagName("a");h(b,"click",q)}if(a.forms){var c=n();h(c.radios,"click",l),h(c.radios,"change",j),h(c.texts,"focus",e),h(c.texts,"blur",g),h(c.checkboxes,"click",l),h(c.checkboxes,"change",k);var f=document.getElementsByTagName("textarea");h(f,"focus",e),h(f,"blur",g);var o=document.getElementsByTagName("select");h(o,"change",i);var p=document.getElementsByTagName("form");h(p,"submit",m)}}function p(a,b){for(var c,d=function(a){return"A"===a.parentNode.tagName?a.parentNode.href:a.parentNode},e=a,f=0;b>f;f+=1){if(c=d(e),"string"==typeof c)return c;e=c}return!1}function q(a){var b,c=a.target||a.srcElement,d=c.tagName;b=this.href?this.href:"A"===d?c.href:p(c,5),b&&socket.emit("location",{url:b})}function r(a,b,c){for(var d=[],e=new RegExp(b),f=0,g=a.length;g>f;f+=1){var h=e.exec(a[f][c]);h&&d.push(f)}return d}function s(a){return document.getElementsByTagName(a)}function t(a){return x.tagNames[a.replace(".","")]}function u(a,b){var c=s(b),d=x.attrs[b];if(c){var e=r(c,a,d);e&&v(c[e],d)}}function v(a,b){var c=a[b],d=/^[^\?]+(?=\?)/.exec(c);d&&(c=d),a[b]=c+"?rel="+(new Date).getTime()}var w={};w.id=Math.random(),w.eventListener=window.addEventListener?"addEventListener":"attachEvent",w.removeEventListener=window.removeEventListener?"removeEventListener":"detachEvent",w.prefix=window.addEventListener?"":"on",w.cache={},w.currentUrl=window.location.href;var x={tagNames:{css:"link",jpg:"img",png:"img",svg:"img",gif:"img",js:"script"},attrs:{link:"href",img:"src",script:"src"}};socket.on("connection",function(a){c(a)}),socket.on("reload",function(a){a&&(a.url?location.reload():u(a.assetUrl,t(a.fileExtention)))}),socket.on("location:update",function(a){a.url&&(window.location=a.url)}),socket.on("scroll:update",function(a){a.url===w.currentUrl&&(w.disabled=!0,window.scrollTo(0,a.position))}),socket.on("input:update",function(b){w.disabled=!0;var c=a(b.id);c.value=b.value}),socket.on("input:update:radio",function(b){w.disabled=!0;var c=a(b.id);c.checked=!0}),socket.on("input:update:checkbox",function(b){w.disabled=!0;var c=a(b.id);c.checked=b.checked}),socket.on("form:submit",function(a){w.disabled=!0,document.forms[a.id].submit()}),document.getScroll=function(){if(void 0!=window.pageYOffset)return[pageXOffset,pageYOffset];var a,b,c=document,d=c.documentElement,e=c.body;return a=d.scrollLeft||e.scrollLeft||0,b=d.scrollTop||e.scrollTop||0,[a,b]}}();